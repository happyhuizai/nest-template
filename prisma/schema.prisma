datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum MenuType {
  DIRECTORY
  MENU
}

model Group {
  id        Int      @id() @default(autoincrement())
  isDeleted Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
  name      String
  users     User[]
  roles     Role[]
}

model User {
  id        Int      @id() @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
  isDeleted Boolean  @default(false)
  username  String   @unique()
  email     String   @unique()
  password  String
  groups    Group[]
}

model Role {
  id          Int          @id() @default(autoincrement())
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt()
  isDeleted   Boolean      @default(false)
  name        String       @unique()
  groups      Group[]
  permissions Permission[]
}

model Permission {
  id        Int      @id() @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
  isDeleted Boolean  @default(false)
  name      String   @unique()
  roles     Role[]
  menus     Menu[]
  policies  Policy[]
}

model Menu {
  id          Int          @id() @default(autoincrement())
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt()
  isDeleted   Boolean      @default(false)
  name        String
  type        MenuType
  icon        String?
  order       Int?
  route       String?
  component   String?
  keepAlive   Boolean?
  hidden      Boolean?     @default(false)
  outlink     String?
  parentId    Int?
  permissions Permission[]
}

model Policy {
  id          Int          @id() @default(autoincrement())
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt()
  action      String
  subject     String
  permissions Permission[]
}
